---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';

const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
const featuredPost = sortedPosts[0];
const recentPosts = sortedPosts.slice(1, 4);

const placeholderImage = '/placeholder.jpg';
---

<Layout title="Bienvenido al Chismesito ü§≠" description="Explora los √∫ltimos chismes y noticias en nuestro blog">
  <h1 class="text-4xl font-bold mb-8">Bienvenido al Chismesito ü§≠</h1>

  <section class="mb-12">
    <h2 class="text-2xl font-semibold mb-4">√öltimo Post</h2>
    <div class="flex flex-col lg:flex-row lg:rounded-tr-[325px] lg:rounded-bl-[325px] border border-slate-900 dark:border-white bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
      <Image 
        src={featuredPost.data.image || placeholderImage}
        alt={featuredPost.data.imageAlt || 'Imagen del post destacado'}
        width={1200}
        height={600}
        class="w-full h-96 object-cover"
      />
      <div class="p-6 flex flex-col justify-end">
        <h3 class="text-2xl font-bold mb-2">{featuredPost.data.title}</h3>
        <p class="text-gray-600 dark:text-gray-400 mb-4">{featuredPost.data.description}</p>
        <a href={`/blog/${featuredPost.slug}`} class="inline-block bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition-colors">
          Leer m√°s
        </a>
      </div>
    </div>
  </section>

  <section>
    <h2 class="text-2xl font-semibold mb-4">Posts Recientes</h2>
    <div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
      {recentPosts.map((post) => (
        <article class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
          <Image 
            src={post.data.image || placeholderImage}
            alt={post.data.imageAlt || 'Imagen del post'}
            width={400}
            height={200}
            class="w-full h-48 object-cover"
          />
          <div class="p-6">
            <h3 class="text-xl font-bold mb-2">{post.data.title}</h3>
            <p class="text-gray-600 dark:text-gray-400 mb-4">{post.data.description}</p>
            <a href={`/blog/${post.slug}`} class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-200">
              Leer m√°s
            </a>
          </div>
        </article>
      ))}
    </div>
  </section>
</Layout>